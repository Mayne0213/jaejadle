generator client {
  provider = "prisma-client"
  output   = "./client"
}

datasource db {
  provider = "mysql"
}

model User {
  id           Int      @id @default(autoincrement())
  userId       String   @unique
  userPassword String
  userName     String
  userPhone    String   @unique
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  announcements Announcement[]

  @@map("users")
}

model Announcement {
  id          Int      @id @default(autoincrement())
  title       String   @default("")
  content     String   @default("") @db.Text
  isImportant Boolean  @default(false)
  viewCount   Int      @default(0)
  authorId    Int
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  author User @relation(fields: [authorId], references: [id], onDelete: Cascade)

  @@index([authorId])
  @@map("announcements")
}

model GalleryPost {
  id        Int      @id @default(autoincrement())
  title     String
  content   String   @default("")  @db.Text
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  images     GalleryImage[]
  textBlocks GalleryTextBlock[]

  @@map("gallery_posts")
}

model GalleryImage {
  id          Int      @id @default(autoincrement())
  fileKey     String
  postId      Int      @default(0)
  order       Int      @default(0) // 이미지 순서
  aspectRatio Float?   // 이미지 비율 (width / height)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  post GalleryPost @relation(fields: [postId], references: [id], onDelete: Cascade)

  @@index([postId])
  @@index([postId, order])
  @@map("gallery_images")
}

model GalleryTextBlock {
  id        Int      @id @default(autoincrement())
  postId    Int
  content   String   @db.Text
  order     Int      // 텍스트 블록 순서
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  post GalleryPost @relation(fields: [postId], references: [id], onDelete: Cascade)

  @@index([postId])
  @@index([postId, order])
  @@map("gallery_text_blocks")
}

model WorshipVideo {
  id        Int      @id @default(autoincrement())
  category  String   // 'sermon', 'praise', 'sunday-school', 'special'
  videoUrl  String   // YouTube video URL
  order     Int      // Display order within category
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([category, order])
  @@index([category])
  @@map("worship_videos")
}
